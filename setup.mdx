---
title: 'Setup'
description: 'Esta seção irá abordar como executar localmente o projeto da api'
---

# API Rails

## Setup inicial
### ASDF
Usamos por padrão o asdf para gerenciar a versão do ruby e do nodejs dos projetos.
```
$ asdf plugin add ruby
$ asdf install ruby 3.1.3
```
caso tenha  algum problema de openssl com o asdf instale a versao 1.1 do openssl. E tente novamente instalar a versao do ruby.
``` 
$ brew install openssl@1.1 
```
Agora basta setar a versao local do ruby como 3.1.3. Na raiz do projeto use o comando:
```
$ asdf local ruby 3.1.3
```

### Dependencias
bundler install
Se der problema com uma dependencia chamada atlas_email_validation, deixe ela comentada no gemfile ou peca autorizacao de acesso a este repositorio e instale novamente.

### Subindo um banco local e usar ele no projeto
Crie um docker-compose.yml em uma pasta isolada dos outros projetos com o conteúdo abaixo:
``` yml
version: "3.5"

services:
  database:
    image: mongo:5.0
    restart: always
    environment:
      MONGO_INITDB_ROOT_USERNAME: root
      MONGO_INITDB_ROOT_PASSWORD: root
    ports:
      - "27017:27017"
    volumes:
      - mongo_data:/data/db

volumes:
  mongo_data:
```
Execute:
```
$ docker-compose up -d
```
Em seguida para os projetos conseguirem acessar o banco gerado execute:
```
$ sudo chmod 777 docker
```
Para começar a usar o banco local no rails crie um arquivo .env na raiz do projeto e cole o seguinte conteudo:
```
API_A3_DB_NAME=atlas-v3
API_A3_DB_USERNAME=root
API_A3_DB_PASSWORD=root
API_A3_DB_AUTHSOURCE=admin
API_A3_DB_PORT=27017
API_A3_HOSTS=localhost
```
Para popular o banco local com alguns dados iniciais use o comando abaixo dentro da pasta do rails:
```
$ bin/rails db:seed
```
Em seguida já podemos entrar no console do rails:
```
bin/rails console
```
Ou inicializar o servidor
```
bin/rails server
```